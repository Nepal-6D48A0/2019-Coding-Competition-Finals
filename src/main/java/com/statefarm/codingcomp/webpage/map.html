<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
    <title>Multiplying LightBulb</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <script src="https://d3js.org/d3.v3.min.js" type="text/javascript"></script>
    <meta charset="utf-8">
    <style>
        .state {
            fill: none;
            stroke: #a9a9a9;
            stroke-width: 1;
        }

        .state:hover {
            fill-opacity: 0.5;
        }

        #tooltip {
            position: absolute;
            text-align: center;
            padding: 20px;
            margin: 10px;
            font: 12px sans-serif;
            background: lightsteelblue;
            border: 1px;
            border-radius: 2px;
            pointer-events: none;
        }

        #tooltip h4 {
            margin: 0;
            font-size: 14px;
        }

        #tooltip {
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid grey;
            border-radius: 5px;
            font-size: 12px;
            width: auto;
            padding: 4px;
            color: white;
            opacity: 0;
        }

        #tooltip table {
            table-layout: fixed;
        }

        #tooltip tr td {
            padding: 0;
            margin: 0;
        }

        #tooltip tr td:nth-child(1) {
            width: 50px;
        }

        #tooltip tr td:nth-child(2) {
            text-align: center;
        }
    </style>
</head>

<body>

    <div id="tooltip"></div><!-- div to hold tooltip. -->
    <svg width="960" height="600" id="statesvg"></svg> <!-- svg to hold the map. -->
    <script src="js/uStates.js"></script> <!-- creates uStates. -->
    <script src="https://d3js.org/d3.v3.min.js"></script>


    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.scrollex.min.js"></script>
    <script src="js/browser.min.js"></script>
    <script src="js/breakpoints.min.js"></script>
    <script src="js/util.js"></script>
    <script src="js/main.js"></script>
    <script src="js/custom.js"></script>

    <script>

        function tooltipHtml(n, d) {	/* function to create html content string in tooltip div. */
            return "<h4>" + n + "</h4><table>" +
                "<tr><td>Low</td><td>" + (d.minIncident) + "</td></tr>" +
                "<tr><td>Average</td><td>" + (d.averageIncidents) + "</td></tr>" +
                "<tr><td>High</td><td>" + (d.maxIncident) + "</td></tr>" +
                "</table>";
        }

        $.get('http://localhost:8080/renters/summary', function (data) {
            generateMap(data);
        });

        function generateMap(data) {
            mapSummary = {};
            data.forEach(summary => {
                mapSummary[summary['state']] = {
                    minIncident: summary['minIncidents'],
                    maxIncident: summary['maxIncidents'],
                    averageIncidents: summary['totalIncidents'] / summary['totalPolicyHolders'],
                    color: d3.interpolate("#ffffcc", "#800026")(low / 100)
                };
            });

            uStates.draw("#statesvg", sampleData, tooltipHtml);

            d3.select(self.frameElement).style("height", "600px");
        }

        // var sampleData = {};	/* Sample random data. */
        // ["HI", "AK", "FL", "SC", "GA", "AL", "NC", "TN", "RI", "CT", "MA",
        //     "ME", "NH", "VT", "NY", "NJ", "PA", "DE", "MD", "WV", "KY", "OH",
        //     "MI", "WY", "MT", "ID", "WA", "DC", "TX", "CA", "AZ", "NV", "UT",
        //     "CO", "NM", "OR", "ND", "SD", "NE", "IA", "MS", "IN", "IL", "MN",
        //     "WI", "MO", "AR", "OK", "KS", "LS", "VA"]
        //     .forEach(function (d) {
        //         var low = Math.round(100 * Math.random()),
        //             mid = Math.round(100 * Math.random()),
        //             high = Math.round(100 * Math.random());

        //         sampleData[d] = {
        //             low: d3.min([low, mid, high]), high: d3.max([low, mid, high]),
        //             avg: Math.round((low + mid + high) / 3), color: d3.interpolate("#ffffcc", "#800026")(low / 100)
        //         };
        //     });

        // /* draw states on id #statesvg */

    </script>

</body>

</html>